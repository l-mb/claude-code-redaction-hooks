rules:
  # Block AWS credentials
  - id: aws-access-key
    pattern: 'AKIA[0-9A-Z]{16}'
    action: block
    description: AWS Access Key ID

  - id: aws-secret-key
    pattern: 'aws_secret_access_key\s*=\s*[A-Za-z0-9/+=]{40}'
    action: block
    description: AWS Secret Access Key

  # Block common API keys
  - id: openai-key
    pattern: 'sk-[a-zA-Z0-9]{32,}'
    action: block
    description: OpenAI API Key

  - id: github-token
    pattern: 'ghp_[a-zA-Z0-9]{36,}'
    action: block
    description: GitHub Personal Access Token

  # Redact email addresses in LLM prompts
  - id: email-pii
    pattern: '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}'
    action: redact
    replacement: email
    target: llm
    description: Email addresses

  # Redact IP addresses
  - id: ip-address
    pattern: '\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'
    action: redact
    replacement: ip
    target: llm
    description: IPv4 addresses

  # Example hashed secret (add with: echo "YourSecret" | redact secret add --id my-secret)
  # - id: my-secret
  #   pattern: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
  #   hashed: true
  #   hash_extractor: '\b\w{4,}\b'
  #   action: block
  #   description: Confidential project name
