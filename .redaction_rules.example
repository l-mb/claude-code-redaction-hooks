rules:
  # Block AWS credentials
  - id: aws-access-key
    pattern: 'AKIA[0-9A-Z]{16}'
    action: block
    description: AWS Access Key ID

  - id: aws-secret-key
    pattern: 'aws_secret_access_key\s*=\s*[A-Za-z0-9/+=]{40}'
    action: block
    description: AWS Secret Access Key

  # Block common API keys
  - id: openai-key
    pattern: 'sk-[a-zA-Z0-9]{32,}'
    action: block
    description: OpenAI API Key

  - id: github-token
    pattern: 'ghp_[a-zA-Z0-9]{36,}'
    action: block
    description: GitHub Personal Access Token

  - id: static-string
    pattern: 'MAGICSTRING'
    action: block
    is_regex: false
    description: Static string to block example

  # Redact email addresses in LLM prompts
  - id: email-pii
    pattern: '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}'
    action: redact
    replacement: email
    target: llm
    description: Email addresses

  # Redact IP addresses
  - id: ip-address
    pattern: '\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'
    action: redact
    replacement: ip
    target: llm
    description: IPv4 addresses

  # Block dangerous git flags (Bash commands only)
  - id: git-no-verify
    pattern: '--no-verify'
    action: block
    tool: Bash
    description: Bypasses pre-commit hooks

  - id: git-push
    pattern: 'push'
    action: block
    tool: Bash
    description: git push requires mandatory human review

  # Path-based rules (block access to certain files/directories)
  - id: block-env-read
    path_pattern: '*.env'
    action: block
    tool: Read
    description: Block reading .env files

  - id: block-secrets-dir
    path_pattern: '**/secrets/**'
    action: block
    description: Block access to secrets directories

  - id: block-etc-passwd
    path_pattern: '/etc/passwd'
    action: block
    tool: Bash
    description: Block accessing system password file

  # Warn action (logs but allows - for files that may be needed occasionally)
  - id: warn-tmp-write
    path_pattern: '/tmp/*'
    action: warn
    tool: Write
    description: Writing to /tmp directory

  - id: warn-dotfiles
    path_pattern: '~/.*'
    action: warn
    description: Accessing home directory dotfiles

  # Combined path + pattern rules (both must match)
  - id: aws-key-in-env
    path_pattern: '*.env'
    pattern: 'AKIA[0-9A-Z]{16}'
    action: block
    tool: Write
    description: Block writing AWS keys to .env files

  - id: dangerous-rm
    path_pattern: '/home/*'
    pattern: 'rm\s+.*-r'
    action: block
    tool: Bash
    description: Block recursive rm on home directories

  # Example hashed secret (add with: echo "YourSecret" | redact secret add --id my-secret)
  # - id: my-secret
  #   pattern: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
  #   hashed: true
  #   hash_extractor: '\b\w{4,}\b'
  #   action: block
  #   description: Confidential project name
